/**
 * Default Configuration - Alpha Exploitation Module
 */

import { AlphaExploitationConfig, AlphaType, ExecutionMode, ExecutionUrgency, MEVProtectionLevel } from '@noderr/types';
import { BigNumber } from 'bignumber.js';

export const DEFAULT_ALPHA_CONFIG: AlphaExploitationConfig = {
  enabled: true,
  mode: 'balanced', // defensive | balanced | aggressive
  
  // Enabled strategy types
  strategies: [
    AlphaType.ARBITRAGE,
    AlphaType.LIQUIDITY_PROVISION,
    AlphaType.STATISTICAL,
    AlphaType.MARKET_MAKING,
    AlphaType.VOLATILITY_CAPTURE,
    AlphaType.MEAN_REVERSION,
    AlphaType.MICROSTRUCTURE,
    AlphaType.CROSS_VENUE
  ],
  
  // Supported venues
  venues: [
    'binance',
    'coinbase',
    'kraken',
    'uniswap',
    'sushiswap',
    'curve',
    'balancer',
    'dydx'
  ],
  
  // Opportunity filters
  minConfidence: 0.75,
  minExpectedReturn: 10, // basis points
  maxRiskScore: 0.3,
  
  // Capital allocation
  capitalAllocation: {
    maxPerOpportunity: new BigNumber('100000'), // $100k max per trade
    maxTotal: new BigNumber('1000000'), // $1M total capital
    reserveRatio: 0.2 // Keep 20% in reserve
  },
  
  // Execution configuration
  execution: {
    mode: ExecutionMode.ADAPTIVE,
    urgency: ExecutionUrgency.NORMAL,
    slippageTolerance: 30, // 30 basis points
    maxImpact: 50, // 50 basis points max market impact
    timeLimit: 5000, // 5 seconds
    smartRouting: true,
    darkPoolAccess: true,
    mevProtection: MEVProtectionLevel.ENHANCED,
    splitStrategy: {
      method: 'ADAPTIVE',
      minSize: new BigNumber('1000'), // $1k minimum
      maxSize: new BigNumber('50000'), // $50k maximum per slice
      venues: [],
      timeRandomization: true
    }
  },
  
  // Analytics configuration
  analytics: {
    updateFrequency: 100, // 100ms updates
    lookbackPeriod: 3600000, // 1 hour lookback
    mlModelsEnabled: true
  },
  
  // Defense configuration
  defense: {
    antiManipulation: true,
    adversarialDetection: true,
    emergencyStop: true
  }
};

// Performance targets for 0.01% elite status
export const PERFORMANCE_TARGETS = {
  latency: {
    p50: 0.5, // 500Î¼s median
    p99: 5,   // 5ms 99th percentile
    p999: 10  // 10ms 99.9th percentile
  },
  execution: {
    fillRate: 0.98,      // 98% fill rate
    slippage: 5,         // 5bps average slippage
    rejectRate: 0.02,    // 2% rejection rate
    costSavings: 10      // 10bps cost savings
  },
  alpha: {
    hitRate: 0.8,        // 80% opportunity success
    sharpeRatio: 3.5,    // 3.5 Sharpe ratio
    profitFactor: 2.5,   // 2.5x profit factor
    maxDrawdown: 0.1     // 10% max drawdown
  },
  ml: {
    predictionAccuracy: 0.93,  // 93% directional accuracy
    patternDetection: 0.87,    // 87% pattern accuracy
    regimeDetection: 0.9,      // 90% regime accuracy
    falsePositiveRate: 0.05   // 5% false positives
  }
};

// Liquidity aggregation configuration
export const LIQUIDITY_CONFIG = {
  aggregation: {
    minVenues: 2,
    maxVenues: 8,
    depthLevels: 20,
    updateFrequency: 50, // 50ms
    staleThreshold: 1000 // 1 second
  },
  provision: {
    spreadTargets: {
      tight: 5,    // 5bps for liquid pairs
      normal: 10,  // 10bps for normal pairs
      wide: 20     // 20bps for illiquid pairs
    },
    inventoryLimits: {
      maxPosition: new BigNumber('50000'), // $50k max position
      rebalanceThreshold: 0.7, // Rebalance at 70% limit
      hedgeRatio: 0.5 // Hedge 50% of inventory
    }
  }
};

// Arbitrage configuration
export const ARBITRAGE_CONFIG = {
  scanning: {
    pairs: 100,           // Monitor top 100 pairs
    venues: 8,            // Across 8 venues
    updateFrequency: 25,  // 25ms updates
    minSpread: 10,        // 10bps minimum spread
    confidence: 0.8       // 80% confidence threshold
  },
  execution: {
    maxLatency: 100,      // 100ms max execution time
    parallelOrders: true,
    atomicExecution: true,
    fallbackStrategy: 'reduce_size'
  },
  flashLoans: {
    enabled: true,
    providers: ['aave', 'dydx', 'uniswap'],
    maxFee: 30, // 30bps max fee
    minProfit: 50, // 50bps minimum profit after fees
    simulation: true // Always simulate first
  }
};

// Microstructure configuration
export const MICROSTRUCTURE_CONFIG = {
  orderflow: {
    toxicityThreshold: 0.7,
    sweepDetection: true,
    icebergDetection: true,
    clusteringWindow: 1000 // 1 second
  },
  impact: {
    model: 'almgren_chriss',
    calibrationFrequency: 3600000, // 1 hour
    adaptiveParameters: true
  },
  signals: {
    imbalanceThreshold: 0.6,
    momentumWindow: 5000, // 5 seconds
    micropriceWeight: 0.7
  }
};

// Defense configuration
export const DEFENSE_CONFIG = {
  manipulation: {
    detectionSensitivity: 0.8,
    washTradeWindow: 30000, // 30 seconds
    spoofingThreshold: 0.7,
    layeringDepth: 5
  },
  protection: {
    mevProtection: true,
    privateMempool: true,
    executionDelay: {
      min: 0,
      max: 100,
      random: true
    },
    orderMasking: {
      sizeJitter: 0.1,      // 10% size randomization
      priceOffsets: [0, 1], // 0-1 tick offsets
      timingJitter: 50      // 50ms timing randomization
    }
  },
  emergency: {
    killSwitch: true,
    maxDailyLoss: 0.05,    // 5% daily loss limit
    maxPositionSize: 0.1,  // 10% of capital max position
    circuitBreakers: {
      volatility: 5,       // 5% price move
      volume: 10,          // 10x normal volume
      spread: 100          // 100bps spread
    }
  }
};

// Analytics configuration
export const ANALYTICS_CONFIG = {
  metrics: {
    updateInterval: 1000, // 1 second
    rollingWindow: 300000 // 5 minutes
  },
  regime: {
    detectionInterval: 10000 // 10 seconds
  },
  export: {
    prometheusInterval: 5000 // 5 seconds
  }
};

// Main configuration export (matches index.ts import)
export const DEFAULT_CONFIG = DEFAULT_ALPHA_CONFIG; 